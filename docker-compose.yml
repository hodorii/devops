redmine:
  restart: always
  build: redmine
  environment:
    - TZ=Asia/Seoul
  # ports:
  #   - "3000:3000"
  volumes:
    - /data/scm/files:/usr/src/redmine/files
    - /data/scm/db:/usr/src/redmine/sqlite
    - /data/scm/log:/usr/src/redmine/log
#    - /data/scm/plugins:/usr/src/redmine/plugins
#    - /data/scm/git:/usr/src/repo/git
#    - /data/scm/svn:/usr/src/repo/svn

jenkins:
  restart: always
  image: jenkins:alpine
  environment:
    - TZ=Asia/Seoul
    - JENKINS_OPTS=--prefix=/jenkins
  # ports:
  #   - "9999:8080"
    - "50000:50000"
  volumes:
    - /data/jenkins/:/var/jenkins_home
    - ~/.m2/repository/:/var/jenkins_home/.m2/repository

svn:
  build: alpine-svn
  #container_name: alpine_svn
  #hostname: alpine-svn
  environment:
  - DAV_SVN_USER=hodorii
  - DAV_SVN_PASS=thdghtjd0
  - SVN_REPO=ecodi
  ports:
  - "9998:80"
  volumes:
  - /data/scm/svnrepo:/var/svn
  restart: always

#svn:
#  restart: always
#  image: "marvambass/subversion"
#  volumes:
#  - /data/scm/svnrepo:/var/local/svn
#  - /data/scm/svnbackup:/var/svn-backup
#  - /data/scm/svnrepo/dav_svn:/etc/apache2/dav_svn
#  ports:
#  - 9998:80

# #사용가능
# svn:
#   restart: always
#   image: "mamohr/subversion-edge"
#   environment:
#     - TZ=Asia/Seoul
#   ports:
#     - 3343:3343
#     - 4434:4434
#     # - 9998:18080
#   volumes:
#     - /data/svn-data:/opt/csvn/data

artifactory:
  restart: always
  build: artifactory
  environment:
    - TZ=Asia/Seoul
    - JAVA_OPTS=-Xms256M -Xmx256M
  # ports:
  #   - 9997:8081
  volumes:
    - /data/artifactory:/usr/local/appdata/artifactory

# archiva:
#   restart: always
#   image: quay.io/lizhongwen/archiva:latest
#   environment:
#     - TZ=Asia/Seoul
#     - MAX_HEAP=256m
#     - MIN_HEAP=256m
#   ports:
#     - 9991:8080
#   volumes:
#     - /data/archiva:/repository

#git:
# image: gitlab/gitlab-ce
# ports:
#  - "80:80"
#  - "2222:22"
#  - "443:443"
# volumes:
#   - ./scm/git:/etc/gitlab
#   - /var/opt/gitlab
#   - /var/log/gitlab

# cloud:
#   image: tomcat:7
#   ports:
#    - "80:8080"

# devtest:
#   image: tomcat:7
#   ports:
#    - "80:8080"


# db:
#  image: mysql:5.7
#  environment:
#   - MYSQL_ROOT_PASSWORD=admin
#   - MYSQL_DATABASE=sonar
#   - MYSQL_USER=sonar
#   - MYSQL_PASSWORD=sonar
#  ports:
#   - "3306:3306"
#  volumes:
#   - /data/mysql:/var/lib/mysql

# sonarqube:
#  image: sonarqube
#  links:
#   - db
#  environment:
#   - SONARQUBE_JDBC_USERNAME=sonar
#   - SONARQUBE_JDBC_PASSWORD=sonar
#   - SONARQUBE_JDBC_URL=jdbc:mysql://localhost/sonar;useUnicode=true
#  ports:
#   - "9000:9000"
#   - "9092:9092"

nginx:
   restart: always
   image: "nginx:alpine"
   volumes:
    - ./default.conf:/etc/nginx/conf.d/default.conf
#  - /data/scm/nginx/scm.conf:/etc/nginx/conf.d/mysite.template
   ports:
  #  - "4000:4000"
   - "80:80"
   environment:
   - TZ=Asia/Seoul
   - NGINX_HOST=hs
   - NGINX_PORT=80
   #command: /bin/bash -c "envsubst < /etc/nginx/conf.d/mysite.template > /etc/nginx/conf.d/default.conf && nginx -g 'daemon off;'"
   links:
   - redmine:redmine
   - jenkins:jenkins
   - svn:svn
   - artifactory:artifactory
